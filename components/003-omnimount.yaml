  omnimount:
    image: kelinger/omnimount
    container_name: omnimount
    hostname: omnimount
    restart: unless-stopped
    environment:
      - USERID=${USERID}
      - GROUPID=${GROUPID}
      - MERGEMOUNT=${MERGEMOUNT}
      - RCLONESERVICE=${RCLONESERVICE}
      - RCLONEMOUNT=${RCLONEMOUNT}
      - UNSYNCED=${UNSYNCED}
      - UPLOADCACHE=${UPLOADCACHE}
      - TZ=${TIMEZONE}
    volumes:
      - ${CONFIGS}/omnimount:/config
      - ${CONFIGS}/healthchecks/omnimountcheck:/omnimountcheck
      - type: bind
        source: ${HOME}/OmniStream/mnt
        target: /mnt
        bind:
          propagation: shared
    privileged: true
    devices:
      - '/dev/fuse'
    healthcheck:
      test: ["CMD-SHELL", "/omnimountcheck"]
      interval: 10s
      timeout: 2s
      retries: 1
